(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{159:function(e){e.exports=JSON.parse('{"a":"https://www.osumc-cultural-awareness.com/api/v1"}')},378:function(e,t,n){e.exports=n(527)},527:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n.n(a),o=n(0),c=n.n(o),s=(n(91),n(43)),i=n(61),u=n(340),l=n(316),m=n(45),p=n(315),d=n(309),f=n(130),h=n(534),v=n(535),g=n(22),b=n.n(g),y=n(14),w=n.n(y),E=n(2),x=n(352),k=n(15),O=n(27),S=n(533),P=n(128),j=n(305),C=n(29),T=n(131),I=n(318),R=n(319),A=n(306),D=n(108),z=n(349),B=n(185),L=n(127),N=n(266),U=n(113),q=n(1),F=q.a.create({spinner:{top:"50%",position:"relative"},specialAddInsight:{padding:10,marginVertical:5,marginHorizontal:5},view:{flex:1},card:{padding:10,marginVertical:5,marginHorizontal:5},fab:{position:"web"===k.a.OS?"fixed":"absolute"}});function M(e){var t=e.insight,n=e.index,a=e.editing,r=e.onPress,o=e.onAction,s=t.source.data;return c.a.createElement(B.a,{style:F.card,onPress:function(){return a&&r(n)}},c.a.createElement(B.a.Content,null,c.a.createElement(L.a,null,t.summary),c.a.createElement(N.a,null,t.information)),c.a.createElement(B.a.Actions,null,s&&D.a.canOpenURL(s)&&c.a.createElement(U.a,{icon:"link",size:20,onPress:function(){o("copy"),z.a.setString(s)}}),s&&D.a.canOpenURL(s)&&c.a.createElement(U.a,{icon:"login-variant",size:20,onPress:function(){o({type:"open",link:s}),D.a.openURL(s)}}),a&&c.a.createElement(U.a,{icon:"delete",size:20,onPress:function(){o({type:"delete",summary:t.summary}),e.onDelete(n)}})))}var V=n(70),K=n(139);function _(e){var t=e.insights,n=e.onRefresh,a=e.renderItem,r=Object(o.useState)(!1),s=w()(r,2),i=s[0],u=s[1];if(!t)return c.a.createElement(P.a,{animating:!0,size:"large",style:F.spinner});var l=function(){u(!0),n(),u(!1)};return c.a.createElement(K.a,null,c.a.createElement(V.a,{data:t,keyExtractor:function(e,t){return t.toString()},onRefresh:function(){return l()},refreshing:i,renderItem:a}))}function H(e){var t=Object(o.useState)(!1),n=w()(t,2),a=n[0],r=n[1];return c.a.createElement(I.a.Group,{visible:!0,open:a,style:F.fab,icon:a?"close":"wrench",actions:[{icon:"plus",onPress:function(){return e.onAdd()}},{icon:"content-save",onPress:function(){return e.onSave()}}],onStateChange:function(){return r(!a)}})}var J=n(36),Q=n(285),G=q.a.create({view:{flex:1,flexDirection:"row"},innerView:{justifyContent:"center"},ripple:{marginRight:15},searchView:{marginEnd:25},title:{fontWeight:"600"}});var Y=Object(s.b)((function(e,t){return{name:e.user.user.name,navigation:t.navigation}}),null)((function(e){var t=e.name,n=e.showSearch,a=e.navigation,r=e.onSearchStart,o=e.onCancel;return c.a.createElement(E.a,{style:G.view},c.a.createElement(E.a,{style:G.innerView},n?c.a.createElement(U.a,{icon:"cancel",onPress:o}):c.a.createElement(U.a,{icon:"magnify",onPress:r})),c.a.createElement(E.a,{style:G.innerView},""===t?c.a.createElement(U.a,{icon:"dots-vertical",onPress:function(){return a.navigate("Settings")}}):c.a.createElement(J.a,{style:G.ripple,onPress:function(){return a.navigate("Settings")}},c.a.createElement(C.a.Text,{size:32,label:t[0]}))))}));function Z(e){var t=e.title,n=e.showSearch,a=e.searchQuery,r=e.onSearchChange,o=e.onSearchStart,s=e.onCancel,i={};return"ios"===k.a.OS&&(i={height:30}),function(e){var u=e.navigation;return{headerTitle:function(){return c.a.createElement(E.a,{style:G.searchView},n?c.a.createElement(Q.a,{autoFocus:!0,placeholder:"search",style:i,onChangeText:r,value:a}):c.a.createElement(L.a,{style:G.title},t))},headerRight:function(){return c.a.createElement(Y,{navigation:u,onSearchStart:o,showSearch:n,onCancel:s})}}}}var $=n(6),W=n.n($),X=n(8),ee=n.n(X),te=n(11),ne=n.n(te),ae=n(13),re=n.n(ae),oe=n(3),ce=n.n(oe),se=n(114),ie=n.n(se),ue=n(159);function le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ce()(e);if(t){var r=ce()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return re()(this,n)}}var me=function(e){ne()(n,e);var t=le(n);function n(e,a){var r;return W()(this,n),(r=t.call(this,e)).reason=e,r.statusCode=a,r}return n}(ie()(Error)),pe=function(e){ne()(n,e);var t=le(n);function n(e){var a;return W()(this,n),(a=t.call(this,"Offline: "+e)).reason=e,a}return n}(ie()(Error)),de=function(){function e(){W()(this,e)}return ee()(e,null,[{key:"get",value:function(e){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.a.awrap(fetch(""+ue.a+encodeURI(e),{method:"GET",headers:{Accept:"application/json"}}));case 3:t=a.sent,a.next=9;break;case 6:throw a.prev=6,a.t0=a.catch(0),new pe(a.t0);case 9:return a.next=11,r.a.awrap(t.json());case 11:if(n=a.sent,t.ok){a.next=14;break}throw new me(n.msg,t.status);case 14:return a.abrupt("return",n);case 15:case"end":return a.stop()}}),null,null,[[0,6]],Promise)}},{key:"getAuth",value:function(e,t){var n,a;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.awrap(fetch(""+ue.a+encodeURI(e),{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+t}}));case 3:n=o.sent,o.next=9;break;case 6:throw o.prev=6,o.t0=o.catch(0),new pe(o.t0);case 9:return o.next=11,r.a.awrap(n.json());case 11:if(a=o.sent,n.ok){o.next=14;break}throw new me(a.msg,n.status);case 14:return o.abrupt("return",a);case 15:case"end":return o.stop()}}),null,null,[[0,6]],Promise)}},{key:"put",value:function(e){var t,n,a,o,c=arguments;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:{},n=c.length>2?c[2]:void 0,s.prev=2,s.next=5,r.a.awrap(fetch(""+ue.a+encodeURI(e),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n},body:JSON.stringify(t)}));case 5:a=s.sent,s.next=11;break;case 8:throw s.prev=8,s.t0=s.catch(2),new pe(s.t0);case 11:return s.next=13,r.a.awrap(a.json());case 13:if(o=s.sent,a.ok){s.next=16;break}throw new me(o.msg,a.status);case 16:return s.abrupt("return",o);case 17:case"end":return s.stop()}}),null,null,[[2,8]],Promise)}},{key:"delete",value:function(e,t){var n,a;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.awrap(fetch(""+ue.a+encodeURI(e),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t}}));case 3:n=o.sent,o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),new pe(o.t0);case 9:return o.next=11,r.a.awrap(n.json());case 11:if(a=o.sent,n.ok){o.next=14;break}throw new me(a.msg,n.status);case 14:return o.abrupt("return",a);case 15:case"end":return o.stop()}}),null,null,[[0,6]],Promise)}},{key:"post",value:function(e){var t,n,a,o,c,s=arguments;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2?s[2]:void 0,a={Accept:"application/json","Content-Type":"application/json"},void 0!==n&&(a.Authorization="Bearer "+n),i.prev=4,i.next=7,r.a.awrap(fetch(""+ue.a+encodeURI(e),{method:"POST",headers:a,body:JSON.stringify(t)}));case 7:o=i.sent,i.next=13;break;case 10:throw i.prev=10,i.t0=i.catch(4),new pe(i.t0);case 13:return i.next=15,r.a.awrap(o.json());case 15:if(c=i.sent,o.ok){i.next=18;break}throw new me(c.msg,o.status);case 18:return i.abrupt("return",c);case 19:case"end":return i.stop()}}),null,null,[[4,10]],Promise)}}]),e}(),fe=function(){function e(t,n,a=!1){W()(this,e),this.name=t,this.email=n,this.superUser=a}return ee()(e,null,[{key:"get",value:function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(de.getAuth("/admins/"+e,t));case 2:return n=a.sent,a.abrupt("return",n);case 4:case"end":return a.stop()}}),null,null,null,Promise)}},{key:"login",value:function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(de.post("/login",{email:e,password:t}));case 2:return n=a.sent,a.abrupt("return",n);case 4:case"end":return a.stop()}}),null,null,null,Promise)}},{key:"list",value:function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.getAuth("/admins",e));case 2:return t=n.sent,n.abrupt("return",t.admins);case 4:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"invite",value:function(e,t){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.post("/admins/invite",{email:e},t));case 2:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"update",value:function(e,t,n){return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(de.put("/admins/"+e,{name:t},n));case 2:case"end":return a.stop()}}),null,null,null,Promise)}},{key:"updatePassword",value:function(e,t,n,a){return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.a.awrap(de.put("/admins/"+e,{password:t,password_confirmation:n},a));case 2:case"end":return o.stop()}}),null,null,null,Promise)}},{key:"recover",value:function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.post("/admins/recover",{email:e}));case 2:return t=n.sent,n.abrupt("return",t.msg);case 4:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"delete",value:function(e,t){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.delete("/admins/"+e,t));case 2:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"create",value:function(e,t,n,a,o){var c;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(de.post("/register",{name:e,email:t,password:n,password_confirmation:a},o));case 2:return c=s.sent,s.abrupt("return",c);case 4:case"end":return s.stop()}}),null,null,null,Promise)}}]),e}(),he=function(){function e(t,n,a,r){W()(this,e),this.name=t,this.generalInsights=n,this.specializedInsights=a,this.modified=r}return ee()(e,[{key:"create",value:function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(de.post("/culture",{name:this.name,general_insights:this.generalInsights,specialized_insights:this.specializedInsights},e));case 2:case"end":return t.stop()}}),null,this,null,Promise)}},{key:"update",value:function(e,t){var n,a;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n={},this.specializedInsights.forEach((function(e,t){return n[t]=e})),a={general_insights:this.generalInsights,specialized_insights:n,name:this.name},o.next=5,r.a.awrap(de.put("/cultures/"+(t||this.name),a,e));case 5:case"end":return o.stop()}}),null,this,null,Promise)}}],[{key:"get",value:function(e){var t,n,a,o,c;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(de.get("/cultures/"+e));case 2:return t=s.sent,n=t.name,a=t.general_insights,o=t.specialized_insights,c=t.modified,s.abrupt("return",new this(n,a,new Map(Object.entries(o)),c));case 5:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"list",value:function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.get("/cultures"));case 2:return e=n.sent,t=e.cultures,n.abrupt("return",new Map(t.map((function(e){return[e.name,e.modified]}))));case 5:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"delete",value:function(e,t){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(de.delete("/cultures/"+e,t));case 2:case"end":return n.stop()}}),null,null,null,Promise)}}]),e}(),ve=n(250),ge="@theme",be="@ledger",ye="@rememberedEmail",we=function(){function e(){W()(this,e)}return ee()(e,null,[{key:"update",value:function(){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(he.list());case 2:return t=a.sent,a.next=5,r.a.awrap(e.list());case 5:n=a.sent,t.forEach((function(t,a){return r.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:n.has(a)&&n.get(a)<t&&e.add(a);case 1:case"end":return r.stop()}}),null,null,null,Promise)}));case 7:case"end":return a.stop()}}),null,null,null,Promise)}},{key:"list",value:function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(m.a.getItem(be));case 2:if(e=n.sent){n.next=5;break}return n.abrupt("return",new Map);case 5:return t=JSON.parse(e).cultures,n.abrupt("return",new Map(Object.entries(t)));case 7:case"end":return n.stop()}}),null,null,null,Promise)}},{key:"read",value:function(e){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(m.a.getItem(e));case 2:if(t=a.sent){a.next=5;break}throw new Error(e+": culture download not found");case 5:return n=ve.inflate(t,{to:"string"}),a.abrupt("return",JSON.parse(n));case 7:case"end":return a.stop()}}),null,null,null,Promise)}},{key:"saveLedger",value:function(e){var t={cultures:{}};e.forEach((function(e,n){return t.cultures[n]=e})),m.a.setItem(be,JSON.stringify(t))}},{key:"add",value:function(t){var n,a,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap(he.get(t));case 2:return n=c.sent,a=ve.deflate(JSON.stringify(n),{to:"string"}),m.a.setItem(t,a.toString()),c.next=7,r.a.awrap(e.list());case 7:(o=c.sent).set(t,n.modified),e.saveLedger(o);case 10:case"end":return c.stop()}}),null,null,null,Promise)}},{key:"remove",value:function(t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(e.list());case 2:(n=a.sent).has(t)&&m.a.removeItem(t),n.delete(t),e.saveLedger(n);case 6:case"end":return a.stop()}}),null,null,null,Promise)}}]),e}(),Ee=function(){function e(){W()(this,e)}return ee()(e,null,[{key:"send",value:function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(de.post("/feedback",{feedback:e}));case 2:case"end":return t.stop()}}),null,null,null,Promise)}}]),e}(),xe=Object(S.a)(),ke={summary:"summary",information:"information",source:{data:"www.example.com",type:"link"}};var Oe=Object(s.b)((function(e,t){return{token:e.user.token,navigation:t.navigation,route:t.route}}),null)((function(e){var t=e.route.params?e.route.params.cultureName:"",n=e.token||"",a=e.navigation,s=Object(o.useState)(null),i=w()(s,2),u=i[0],l=i[1],m=Object(o.useState)(!1),p=w()(m,2),d=p[0],f=p[1],h=Object(o.useState)(""),v=w()(h,2),g=v[0],y=v[1],S=Object(o.useState)(!1),D=w()(S,2),z=D[0],B=D[1],L=Object(o.useState)(!!e.route.params&&e.route.params.dirty),N=w()(L,2),U=N[0],q=N[1],V=Object(o.useState)(""),K=w()(V,2),J=K[0],Q=K[1],G=Object(o.useState)(!1),Y=w()(G,2),$=Y[0],W=Y[1],X=Object(O.useRoute)();Object(o.useLayoutEffect)((function(){var e=Z({title:t,searchQuery:J,showSearch:$,onSearchChange:function(e){return Q(e)},onSearchStart:function(){return W(!0)},onCancel:function(){return W(!1)}});a.setOptions(e({navigation:a}))}),[a,$,J,t]),Object(o.useEffect)((function(){te()}),[]),c.a.useEffect((function(){return a.addListener("beforeRemove",(function(t){(U||e.route.params.dirty)&&(t.preventDefault(),"web"===k.a.OS?confirm("You have unsaved changes. Are you sure you want to discard them and leave the screen?")&&a.dispatch(t.data.action):x.a.alert("Discard changes?","You have unsaved changes. Are you sure you want to discard them and leave the screen?",[{text:"Cancel",style:"cancel",onPress:function(){return t.preventDefault()}},{text:"Discard",style:"destructive",onPress:function(){return a.dispatch(t.data.action)}}],{cancelable:!1}))}))}),[a,U]);var ee=function(e){var t=new he(e.name,e.generalInsights,e.specializedInsights,e.modified);q(!0),l(t)},te=function(){var a,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,r.a.awrap(he.get(t));case 3:a=c.sent,l(a),c.next=20;break;case 7:return c.prev=7,c.t0=c.catch(0),c.prev=9,c.next=12,r.a.awrap(we.read(t));case 12:o=c.sent,l(o),c.next=20;break;case 16:c.prev=16,c.t1=c.catch(9),console.error(c.t1),n?(B(!0),f(!0),l(new he(t,[],new Map,Date.now()))):e.navigation.navigate("Home");case 20:case"end":return c.stop()}}),null,null,[[0,7],[9,16]],Promise)},ne=function(){return y("")},ae=function(e){if("copy"!==e)switch(e.type){case"open":y("Opening "+e.link);break;case"delete":y("Deleting "+e.summary)}else y("Link copied!")};if(!u)return c.a.createElement(P.a,{animating:!0,size:"large",style:F.spinner});var re,oe,ce=function(e){if(e instanceof Array){var t=w()(e,2),n=t[0],a=t[1],r=u.specializedInsights.get(n);r.splice(a,1),u.specializedInsights.set(n,r),0===r.length&&u.specializedInsights.delete(n)}else u.generalInsights.splice(e,1);ee(u)},se=function(t,n){return c.a.createElement(M,{key:"insight-card-"+n.toString(),index:n,editing:d,insight:t,onAction:ae,onPress:function(t){return e.navigation.navigate("EditInsight",{culture:u,index:t})},onDelete:ce})},ie=function(e,t){return e.filter((function(e){if(!t)return!0;var n=(e.summary+e.information).toLowerCase(),a=t.toLowerCase();return n.includes(a)}))}(u.generalInsights,J),ue=(re=u.specializedInsights,oe=J,Array.from(re.entries()).map((function(e){var t=w()(e,2),n=t[0],a=t[1];return oe?[n,a.filter((function(e){if(!oe)return!0;var t=(e.summary+e.information).toLowerCase(),n=oe.toLowerCase();return t.includes(n)}))]:[n,a]})).filter((function(e){return 0!==e[1].length})));return c.a.createElement(E.a,{style:F.view},""!==n&&c.a.createElement(j.a,{icon:"alert",visible:z,actions:[{label:"Ok",onPress:function(){return B(!1)}}]},"Welcome to a brand new Culture!\n\n1. To add a new insight hit the tool button\n2. To edit an insight click on it\n3. Don't forget to save!\n"),c.a.createElement(xe.Navigator,{initialRouteName:"general"},c.a.createElement(xe.Screen,{name:"general"},(function(){return c.a.createElement(_,{renderItem:function(e){return se(e.item,e.index)},onRefresh:function(){te(),q(!1)},insights:ie})})),c.a.createElement(xe.Screen,{name:"specialized"},(function(){return c.a.createElement(_,{insights:ue,onRefresh:function(){te(),q(!1)},renderItem:function(e){var t=w()(e.item,2),n=t[0],a=t[1];return c.a.createElement(C.b.Accordion,{title:n,id:e.index},a.map((function(e,t){return se(e,[n,t])})),d&&c.a.createElement(T.a,{icon:"plus",onPress:function(){return e=n,u.specializedInsights.set(e,[].concat(b()(u.specializedInsights.get(e)),[ke])),void ee(u);var e},mode:"contained",style:F.specialAddInsight},""))}})}))),""!==n&&d&&c.a.createElement(H,{onSave:function(){return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.a.awrap(u.update(n,e.route.params.prevName));case 3:ee(u),q(!1),a.setParams({cultureName:t,dirty:!1,prevName:e.route.params.prevName}),o.next=12;break;case 8:o.prev=8,o.t0=o.catch(0),y(o.t0.toString()),console.error(o.t0);case 12:f(!d);case 13:case"end":return o.stop()}}),null,null,[[0,8]],Promise)},onAdd:function(){var e;switch(null!=(e=Object(O.getFocusedRouteNameFromRoute)(X))?e:"general"){case"general":u.generalInsights.push(ke);break;case"specialized":u.specializedInsights.set("Specialized Insight",[ke])}ee(u)}}),""!==n&&!d&&c.a.createElement(I.a.Group,{icon:"pencil",style:F.fab,open:!1,onPress:function(){return f(!d)},visible:!0,actions:[],onStateChange:function(){return f(!d)}}),c.a.createElement(R.a,null,c.a.createElement(A.a,{visible:""!==g,onDismiss:ne,action:{label:"Ok",onPress:ne}},g)))})),Se=n(311),Pe=n(307),je=n(314),Ce=n(68),Te=n(12),Ie=n.n(Te);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Ie()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var De={user:Ae({},new fe("","")),token:""},ze=function(e){return{type:"UPDATE_USER",payload:e}},Be=function(){return{type:"RESET_USER",payload:{}}},Le=function(e){return{type:"UPDATE_THEME",payload:e}},Ne=Object(i.b)({theme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Dark",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_THEME":return t.payload;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USER":return Ae({},t.payload);case"RESET_USER":return Ae({},De);default:return e}}}),Ue=n(32),qe=Ue.a().shape({email:Ue.c().email("Invalid email address").required("Required"),password:Ue.c().required("Required")}),Fe={email:"",password:""},Me=q.a.create({view:{flex:1,justifyContent:"space-evenly",margin:15,overflow:"hidden"},recover:{position:"absolute",bottom:5}});var Ve=Object(s.b)(null,(function(e){return Object(i.a)({updateUser:ze},e)}))((function(e){var t=Object(o.useState)(!1),n=w()(t,2),a=n[0],s=n[1],i=Object(o.useState)(""),u=w()(i,2),l=u[0],p=u[1],d=Object(o.useState)(!0),f=w()(d,2),h=f[0],v=f[1],g=Object(o.useRef)(),b=Object(o.useRef)(),y=Object(Ce.a)({validationSchema:qe,initialValues:Fe,onSubmit:function(e){return D(e)}}),x=y.values,k=y.handleChange,S=y.handleBlur,P=y.errors,j=y.touched,C=y.handleSubmit,I=y.setFieldValue,R=y.validateField;Object(o.useEffect)((function(){!function(){var e;r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(m.a.getItem(ye));case 2:(e=t.sent)&&(I("email",e),s(!0));case 4:case"end":return t.stop()}}),null,null,null,Promise)}()}),[]);var D=function(t){var n,o,c,s,i;return r.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=t.email,o=t.password,c=e.navigation,s=e.updateUser,u.prev=2,u.next=5,r.a.awrap(fe.login(n,o));case 5:i=u.sent,u.next=12;break;case 8:return u.prev=8,u.t0=u.catch(2),p(u.t0.toString()),u.abrupt("return");case 12:if(u.prev=12,!a){u.next=18;break}return u.next=16,r.a.awrap(m.a.setItem(ye,n));case 16:u.next=20;break;case 18:return u.next=20,r.a.awrap(m.a.removeItem(ye));case 20:u.next=25;break;case 22:u.prev=22,u.t1=u.catch(12),console.error("Failed to set Remembered Email",u.t1);case 25:s(i),c.dispatch(O.CommonActions.reset({index:1,routes:[{name:"Home"}]}));case 27:case"end":return u.stop()}}),null,null,[[2,8],[12,22]],Promise)};return c.a.createElement(E.a,{style:Me.view},c.a.createElement(E.a,null,c.a.createElement(Se.a,{textContentType:"emailAddress",autoFocus:!0,onSubmitEditing:function(){var e;(e=b)&&e.current.focus()},mode:"outlined",error:P.email&&j.email,left:c.a.createElement(Se.a.Icon,{name:"email"}),keyboardType:"email-address",label:"email",ref:g,value:x.email,onBlur:S("email"),returnKeyType:"next",onChangeText:k("email")}),P.email&&j.email&&c.a.createElement(Pe.a,{type:"error"},P.email)),c.a.createElement(E.a,null,c.a.createElement(Se.a,{mode:"outlined",label:"password",textContentType:"password",ref:b,left:c.a.createElement(Se.a.Icon,{name:"lock"}),secureTextEntry:h,onSubmitEditing:C,error:P.password&&j.password,onBlur:S("password"),value:x.password,returnKeyType:"done",onChangeText:k("password"),right:c.a.createElement(Se.a.Icon,{name:h?"eye":"eye-off",onPress:function(){return v(!h)}})}),P.password&&j.password&&c.a.createElement(Pe.a,{type:"error"},P.password)),c.a.createElement(je.a.Item,{label:"Remember me",status:a?"checked":"unchecked",onPress:function(){return s(!a)}}),c.a.createElement(T.a,{mode:"contained",onPress:C},"Log In"),c.a.createElement(T.a,{style:Me.recover,mode:"text",onPress:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(R("email"));case 2:if(void 0===P.email){e.next=5;break}return p("Account recovery requires a valid Email"),e.abrupt("return");case 5:return e.prev=5,e.next=8,r.a.awrap(fe.recover(x.email));case 8:p("Sent email to "+x.email),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(5),console.error("Failed to send recovery email: ",e.t0),p(e.t0.toString());case 15:case"end":return e.stop()}}),null,null,[[5,11]],Promise)},uppercase:!1},"Trouble logging in?"),c.a.createElement(A.a,{visible:""!==l,onDismiss:function(){return p("")},action:{label:"Ok",onPress:function(){return p("")}}},l))})),Ke=n(33),_e={name:"This is how other administrators will see you. You can always change this later.",email:"You'll need this if you ever forget your password.",password:"Strong passwords include a mix of lower case letters, uppercase letters, numbers, and special characters.",passwordConfirmation:"Double check that you know the password."},He=Ue.a().shape({name:Ue.c().min(2,"Too short").max(64,"Too long").required("Required"),email:Ue.c().email("Invalid email address").required("Required"),password:Ue.c().required("Required").min(8,"Must be at least 8 characters").max(64,"Too long").matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]/,"Must contain at least one uppercase letter, one lowercase letter, one number and one special character"),passwordConfirmation:Ue.c().required("Required").oneOf([Ue.b("password"),null],"Must match password")}),Je={name:"",email:"",password:"",passwordConfirmation:""},Qe=q.a.create({view:{flex:1,justifyContent:"space-evenly",margin:15,overflow:"hidden"},link:{color:"blue",fontWeight:"bold"}});var Ge=Object(s.b)(null,(function(e){return Object(i.a)({updateUser:ze},e)}))((function(e){var t=e.route.params?e.route.params.token:"",n=Object(o.useState)(!0),a=w()(n,2),s=a[0],i=a[1],u=Object(o.useState)(!0),l=w()(u,2),m=l[0],p=l[1],d=Object(o.useState)(""),f=w()(d,2),h=f[0],v=f[1],g=Object(o.useState)("email"),b=w()(g,2),y=b[0],x=b[1],k=Object(o.useRef)(),S=Object(o.useRef)(),P=Object(o.useRef)(),j=Object(o.useRef)(),C=Object(Ce.a)({validationSchema:He,initialValues:Je,onSubmit:function(e){return U(e)}}),I=C.values,R=C.handleChange,z=C.handleBlur,B=C.errors,L=C.touched,N=C.handleSubmit,U=function(n){var a,o,c,s,i,u,l;return r.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:return a=n.name,o=n.email,c=n.password,s=n.passwordConfirmation,i=e.navigation,u=e.updateUser,m.prev=2,m.next=5,r.a.awrap(fe.create(a,o,c,s,t));case 5:l=m.sent,m.next=12;break;case 8:return m.prev=8,m.t0=m.catch(2),v(m.t0.toString()),m.abrupt("return");case 12:u(l),i.dispatch(O.CommonActions.reset({index:1,routes:[{name:"Home"}]}));case 14:case"end":return m.stop()}}),null,null,[[2,8]],Promise)},q=function(e){var t=e.fieldName;return y===t||B[t]&&L[t]?B[t]&&L[t]?c.a.createElement(Pe.a,{type:"error"},B[t]):c.a.createElement(Pe.a,{type:"info"},_e[t]):null},F=function(e){e&&e.current.focus()};return c.a.createElement(E.a,{style:Qe.view},c.a.createElement(E.a,null,c.a.createElement(Se.a,{autoFocus:!0,textContentType:"emailAddress",onFocus:function(){return x("email")},onSubmitEditing:function(){return F(k)},returnKeyType:"next",mode:"outlined",keyboardType:"email-address",error:B.email&&L.email,left:c.a.createElement(Se.a.Icon,{name:"email"}),label:"email",ref:S,value:I.email,onChangeText:R("email"),onBlur:z("email")}),c.a.createElement(q,{fieldName:"email"})),c.a.createElement(E.a,null,c.a.createElement(Se.a,{textContentType:"name",onFocus:function(){return x("name")},onSubmitEditing:function(){return F(P)},returnKeyType:"next",mode:"outlined",error:B.name&&L.name,left:c.a.createElement(Se.a.Icon,{name:"account"}),label:"name",ref:k,value:I.name,onChangeText:R("name"),onBlur:z("name")}),c.a.createElement(q,{fieldName:"name"})),c.a.createElement(E.a,null,c.a.createElement(Se.a,{mode:"outlined",label:"password",onFocus:function(){return x("password")},onSubmitEditing:function(){return F(j)},returnKeyType:"next",textContentType:"newPassword",keyboardType:"visible-password",ref:P,left:c.a.createElement(Se.a.Icon,{name:"lock"}),secureTextEntry:s,error:B.password&&L.password,onBlur:z("password"),value:I.password,onChangeText:R("password"),right:c.a.createElement(Se.a.Icon,{name:s?"eye":"eye-off",onPress:function(){return i(!s)}})}),c.a.createElement(q,{fieldName:"password"})),c.a.createElement(E.a,null,c.a.createElement(Se.a,{mode:"outlined",label:"password confirmation",onFocus:function(){return x("passwordConfirmation")},onSubmitEditing:N,returnKeyType:"done",textContentType:"password",keyboardType:"visible-password",ref:j,left:c.a.createElement(Se.a.Icon,{name:"shield-lock"}),secureTextEntry:m,error:B.passwordConfirmation&&L.passwordConfirmation,onBlur:z("passwordConfirmation"),value:I.passwordConfirmation,onChangeText:R("passwordConfirmation"),right:c.a.createElement(Se.a.Icon,{name:m?"eye":"eye-off",onPress:function(){return p(!m)}})}),c.a.createElement(q,{fieldName:"passwordConfirmation"})),c.a.createElement(E.a,null,c.a.createElement(Ke.a,null,"By clicking Register, you are indicating that you have read and acknowledged the",c.a.createElement(Ke.a,{onPress:function(){return D.a.openURL("http://www.google.com")},style:Qe.link}," ","Terms of Service"),".")),c.a.createElement(T.a,{mode:"contained",onPress:N},"Register"),c.a.createElement(A.a,{visible:""!==h,onDismiss:function(){return v("")},action:{label:"Ok",onPress:function(){return v("")}}},h))})),Ye=n(85),Ze=n(125);function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach((function(t){Ie()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xe=We(We({},Ye.a),{},{roundness:2,colors:We(We({},Ye.a.colors),{},{primary:"#1e88e5",accent:"#1e88e5"})}),et=We(We({},Ze.a),{},{roundness:2,colors:We(We({},Ze.a.colors),{},{primary:"#1e88e5",accent:"#1e88e5"})}),tt=q.a.create({spinner:{top:"50%",position:"relative"},view:{flex:1},modalLight:{margin:40,padding:40,backgroundColor:Xe.colors.background},modalDark:{margin:40,padding:40,backgroundColor:et.colors.background},list:{flex:1},div:{margin:"5px"},deleteButton:{backgroundColor:"red",margin:5},fab:{position:"web"===k.a.OS?"fixed":"absolute",margin:16,right:0,bottom:0},ListActions:{flexDirection:"row"},editModalInput:{paddingBottom:10},cultureListActions:{flex:1,flexDirection:"row",justifyContent:"flex-end"},dialogButton:{margin:5}});function nt(e){var t=e.cultures,n=e.onRefresh,a=e.token,s=e.searchQuery,i=e.offline,u=e.onMsg,l=Object(o.useState)(!1),m=w()(l,2),p=m[0],d=m[1],f=Object(o.useState)(new Map),h=w()(f,2),v=h[0],g=h[1],b=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(we.list());case 3:e=t.sent,g(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),u(t.t0.toString());case 10:case"end":return t.stop()}}),null,null,[[0,7]],Promise)};if(Object(O.useFocusEffect)(c.a.useCallback((function(){b()}),[])),!t)return c.a.createElement(P.a,{animating:!0,size:"large",style:tt.spinner});var y=t.filter((function(e){var t=w()(e,1)[0];if(!s)return!0;var n=t.toLowerCase(),a=s.toLowerCase();return n.includes(a)}));return c.a.createElement(E.a,null,c.a.createElement(V.a,{data:y,keyExtractor:function(e,t){return t.toString()},onRefresh:function(){d(!0),n(),d(!1)},refreshing:p,renderItem:function(t){var o=t.item,s=w()(o,1)[0];return c.a.createElement(C.b.Item,{title:s,onPress:function(){return e.navigation.navigate("Culture",{cultureName:s})},right:function(){return c.a.createElement(E.a,{style:tt.cultureListActions},!i&&!v.has(s)&&c.a.createElement(U.a,{icon:"download",onPress:function(){return function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(we.add(e));case 3:b(),u("Downloaded "+e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),u(t.t0.toString());case 10:case"end":return t.stop()}}),null,null,[[0,7]],Promise)}(s)}}),""!==a&&c.a.createElement(U.a,{icon:"delete",onPress:function(){return function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(he.delete(e,a));case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),u(t.t0.toString()),console.error("Failed to delete culture",t.t0);case 9:n();case 10:case"end":return t.stop()}}),null,null,[[0,5]],Promise)}(s)}}))}})}}))}var at=n(17),rt=n(313),ot=Ue.a().shape({email:Ue.c().email("Invalid email address").required("Required")}),ct=Ue.a().shape({email:Ue.c().email("Invalid email address").required("Required"),name:Ue.c().required("Required")});function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){Ie()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ut={email:"",name:""};function lt(e){var t=e.admin,n=e.token,a=e.show,s=e.onDismiss,i=e.onErr,u=e.onRefresh,l=Object(o.useRef)(),m=Object(at.b)(),p=Object(Ce.a)({validationSchema:ct,initialValues:ut,onSubmit:function(e){return k(e)}}),d=p.values,f=p.handleChange,h=p.handleBlur,v=p.errors,g=p.touched,b=p.handleSubmit,y=p.setErrors,w=p.validateForm,x=p.setFieldValue;Object(o.useEffect)((function(){x("email",null==t?void 0:t.email),x("name",null==t?void 0:t.name)}),[t]);var k=function(e){var a,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a=e.name,o=e.email,c.next=3,r.a.awrap(w());case 3:if(a!==t.name){c.next=6;break}return y(it(it({},v),{},{name:"That's your current name"})),c.abrupt("return");case 6:return c.prev=6,c.next=9,r.a.awrap(fe.update(o,a,n));case 9:s(),u(),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(6),i(c.t0.toString());case 16:case"end":return c.stop()}}),null,null,[[6,13]],Promise)};return c.a.createElement(rt.a,{visible:a,onDismiss:s,style:{backgroundColor:m.colors.surface}},c.a.createElement(rt.a.Title,null,"Edit ",null==t?void 0:t.name),c.a.createElement(rt.a.Content,null,c.a.createElement(Se.a,{mode:"outlined",style:tt.editModalInput,left:c.a.createElement(Se.a.Icon,{name:"email"}),label:"email",value:d.email,disabled:!0}),c.a.createElement(E.a,null,c.a.createElement(Se.a,{autoFocus:!0,textContentType:"name",mode:"outlined",left:c.a.createElement(Se.a.Icon,{name:"account"}),error:v.name&&g.name,onSubmitEditing:b,returnKeyType:"done",label:"name",value:d.name,ref:l,onBlur:h("name"),onChangeText:f("name")}),v.name&&g.name&&c.a.createElement(Pe.a,{type:"error"},v.name))),c.a.createElement(rt.a.Actions,null,c.a.createElement(T.a,{style:tt.dialogButton,onPress:s},"Cancel"),c.a.createElement(T.a,{style:tt.dialogButton,mode:"contained",onPress:b},"Save")))}var mt=Object(s.b)((function(e){return{user:e.user.user,theme:e.theme}}),null)((function(e){var t=e.user,n=e.token,a=e.admins,s=e.onRefresh,i=e.searchQuery,u=e.onMsg,l=Object(at.b)(),m=Object(o.useState)(!1),p=w()(m,2),d=p[0],f=p[1],h=Object(o.useState)(!1),v=w()(h,2),g=v[0],b=v[1],y=Object(o.useState)(null),x=w()(y,2),k=x[0],O=x[1];return c.a.createElement(V.a,{style:tt.list,data:a.filter((function(e){if(!i)return!0;var t=e.email.toLowerCase(),n=i.toLowerCase();return t.includes(n)})),keyExtractor:function(e,t){return t.toString()},renderItem:function(a){var o=a.item;return c.a.createElement(E.a,null,c.a.createElement(C.b.Item,{title:o.email,right:function(){return""!==e.token&&c.a.createElement(E.a,{style:tt.ListActions},c.a.createElement(U.a,{icon:"pencil",onPress:function(){b(!0),O(o)}}),!o.superUser&&o.email!=t.email&&c.a.createElement(U.a,{icon:"delete",onPress:function(){f(!0),O(o)}}))}}),c.a.createElement(R.a,null,c.a.createElement(rt.a,{visible:d,onDismiss:function(){return f(!1)},style:{backgroundColor:l.colors.surface}},c.a.createElement(rt.a.Title,null,"Are you sure you want to delete ",null==k?void 0:k.email,"?"),c.a.createElement(rt.a.Actions,null,c.a.createElement(T.a,{style:tt.dialogButton,onPress:function(){return f(!1)}},"Cancel"),c.a.createElement(T.a,{mode:"contained",onPress:function(){r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.a.awrap(fe.delete(k.email,n));case 3:s(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),u(e.t0.toString());case 9:case"end":return e.stop()}}),null,null,[[0,6]],Promise),f(!1)},style:tt.deleteButton},"Delete"))),c.a.createElement(lt,{show:g,token:n,admin:k,onDismiss:function(){return b(!1)},onErr:u,onRefresh:s})))}})})),pt={email:""};function dt(e){var t=e.token,n=e.show,a=e.onDismiss,s=e.onErr,i=Object(at.b)(),u=Object(o.useRef)(),l=Object(Ce.a)({validationSchema:ot,initialValues:pt,onSubmit:function(e){return b(e)}}),m=l.values,p=l.handleChange,d=l.handleBlur,f=l.errors,h=l.touched,v=l.handleSubmit,g=l.validateField,b=function(e){var n;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=e.email,o.next=3,r.a.awrap(g("email"));case 3:return o.prev=3,o.next=6,r.a.awrap(fe.invite(n,t));case 6:a(),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(3),s(o.t0.toString());case 12:case"end":return o.stop()}}),null,null,[[3,9]],Promise)};return c.a.createElement(rt.a,{visible:n,onDismiss:a,style:{backgroundColor:i.colors.surface}},c.a.createElement(rt.a.Title,null,"Invite a new Admin"),c.a.createElement(rt.a.Content,null,c.a.createElement(Se.a,{textContentType:"emailAddress",autoFocus:!0,mode:"outlined",onSubmitEditing:v,returnKeyType:"send",left:c.a.createElement(Se.a.Icon,{name:"email"}),error:f.email&&h.email,label:"email",value:m.email,ref:u,onBlur:d("email"),onChangeText:p("email")})),c.a.createElement(rt.a.Actions,null,c.a.createElement(T.a,{style:tt.dialogButton,onPress:a},"Cancel"),c.a.createElement(T.a,{mode:"contained",style:tt.dialogButton,onPress:v},"Invite")))}var ft=Object(S.a)();var ht=Object(s.b)((function(e,t){return{navigation:t.navigation,route:t.route,user:e.user.user,token:e.user.token,theme:e.theme}}),null)((function(e){var t=e.token,n=e.route,a=e.user,s=e.navigation,i=Object(o.useState)(null),u=w()(i,2),l=u[0],m=u[1],p=Object(o.useState)(null),d=w()(p,2),f=d[0],h=d[1],v=c.a.useState(!1),g=w()(v,2),y=g[0],x=g[1],k=Object(o.useState)(""),S=w()(k,2),j=S[0],C=S[1],T=Object(o.useState)(!1),D=w()(T,2),z=D[0],B=D[1],L=Object(o.useState)(void 0),N=w()(L,2),U=N[0],q=N[1],F=Object(o.useState)(!1),M=w()(F,2),V=M[0],K=M[1];Object(o.useLayoutEffect)((function(){var e=Z({title:"Cultural Awareness",searchQuery:U,showSearch:V,onSearchChange:function(e){return q(e)},onSearchStart:function(){return K(!0)},onCancel:function(){return K(!1)}});s.setOptions(e({navigation:s}))}),[s,V,U]);var _=function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.a.awrap(he.list());case 3:e=n.sent,m(e),n.next=24;break;case 7:if(n.prev=7,n.t0=n.catch(0),!(n.t0 instanceof pe)){n.next=23;break}return n.prev=10,n.next=13,r.a.awrap(we.list());case 13:t=n.sent,m(t),B(!0),n.next=21;break;case 18:n.prev=18,n.t1=n.catch(10),C(n.t1.toString());case 21:n.next=24;break;case 23:C(n.t0.toString());case 24:case"end":return n.stop()}}),null,null,[[0,7],[10,18]],Promise)};Object(o.useEffect)((function(){_()}),[]);var H=function(){var n;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.token){o.next=2;break}return o.abrupt("return");case 2:if(o.prev=2,!a.superUser){o.next=9;break}return o.next=6,r.a.awrap(fe.list(t));case 6:o.t0=o.sent,o.next=10;break;case 9:o.t0=[a];case 10:n=o.t0,h(n),o.next=17;break;case 14:o.prev=14,o.t1=o.catch(2),C(o.t1.toString());case 17:case"end":return o.stop()}}),null,null,[[2,14]],Promise)};Object(o.useEffect)((function(){H()}),[]);var J=l?b()(l.entries()):[];return t?f?c.a.createElement(E.a,{style:tt.view},c.a.createElement(ft.Navigator,{initialRouteName:"Cultures"},c.a.createElement(ft.Screen,{name:"Cultures"},(function(){return c.a.createElement(nt,{navigation:s,token:t,searchQuery:U,cultures:J,onRefresh:function(){return _()},offline:z,onMsg:function(e){return C(e)}})})),c.a.createElement(ft.Screen,{name:"Admins"},(function(){return c.a.createElement(mt,{token:t,admins:f,onRefresh:function(){return H()},searchQuery:U,onMsg:function(e){return C(e)}})}))),c.a.createElement(I.a,{style:tt.fab,icon:"plus",onPress:function(){var e;switch(null!=(e=Object(O.getFocusedRouteNameFromRoute)(n))?e:"Cultures"){case"Cultures":m(new Map([].concat(b()(l.entries()),[["New Culture",Date.now()]])));break;case"Admins":x(!0)}}}),c.a.createElement(R.a,null,c.a.createElement(A.a,{visible:""!=j,onDismiss:function(){return C("")},action:{label:"Ok",onPress:function(){return C("")}}},j),c.a.createElement(dt,{show:y,token:t,onDismiss:function(){return x(!1)},onErr:function(e){return C(e)}}))):c.a.createElement(P.a,{animating:!0,size:"large",style:tt.spinner}):c.a.createElement(E.a,null,c.a.createElement(nt,{navigation:e.navigation,token:"",cultures:J,onRefresh:function(){return _()},searchQuery:U,offline:z,onMsg:function(e){return C(e)}}),c.a.createElement(R.a,null,c.a.createElement(A.a,{visible:""!=j,onDismiss:function(){return C("")},action:{label:"Ok",onPress:function(){return C("")}}},j)))})),vt=n(308),gt=n(312);var bt=q.a.create({view:{flex:1,justifyContent:"space-evenly",overflow:"hidden"},fab:{position:"absolute",alignSelf:"center",bottom:0,margin:16},input:{paddingHorizontal:10,margin:5},sourceTypeTitle:{margin:10}}),yt={summary:"summary",information:"information",source:{data:"www.example.com",type:"link"}};var wt=function(e){var t=e.route.params?e.route.params.index:0,n=e.route.params?e.route.params.culture:new he("Unknown",[yt],new Map,0),a=t instanceof Array,s=t instanceof Array?n.specializedInsights.get(t[0])[t[1]]:n.generalInsights[t],i=t instanceof Array?t[0]:"";Object(o.useEffect)((function(){return e.navigation.setOptions({title:s.summary||"Unknown"})}),[]);var u,l={cultureName:n.name,title:i,summary:s.summary,description:s.information,source:s.source.data,sourceType:s.source.type},m=Object(Ce.a)({validationSchema:(u=a?"specialized":"general",Ue.a().shape({cultureName:Ue.c().required("Required"),title:"specialized"===u&&Ue.c().required("Required"),summary:Ue.c().required("Required"),description:Ue.c().required("Required"),source:Ue.c().required("Required"),sourceType:Ue.c().required("Required")})),initialValues:l,onSubmit:function(e){return b(e)}}),p=m.values,d=m.handleChange,f=m.handleBlur,h=m.errors,v=m.touched,g=m.handleSubmit,b=function(a){var o,c,u,l,m,p,d,f,h,v,g,b,y;return r.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:o=a.cultureName,c=a.title,u=a.summary,l=a.description,m=a.source,p=a.sourceType,d={summary:u,information:l,source:{data:m,type:p}},t instanceof Array?(f=w()(t,2),h=f[0],v=f[1],(g=n.specializedInsights.get(h))[v]=d,c!==t[0]&&(n.specializedInsights.delete(h),n.specializedInsights.set(c,g))):n.generalInsights[t]=d,b=n.name,y=i!==c||u!==s.summary||l!==s.information||m!==s.source.data||p!==s.source.type||o!==b,n.name=o,e.navigation.navigate("Culture",{cultureName:n.name,prevName:b,dirty:y});case 7:case"end":return r.stop()}}),null,null,null,Promise)},y=function(e){e&&e.current.focus()},x=Object(o.useRef)(),k=Object(o.useRef)(),O=Object(o.useRef)(),S=Object(o.useRef)(),P=Object(o.useRef)();return c.a.createElement(E.a,{style:bt.view},c.a.createElement(E.a,null,c.a.createElement(Se.a,{style:bt.input,value:p.cultureName,onBlur:f("cultureName"),onSubmitEditing:function(){return y(a?k:O)},ref:x,placeholder:"Culture Name",returnKeyType:"next",label:"Culture Name",mode:"outlined",onChangeText:d("cultureName")}),h.cultureName&&v.cultureName&&c.a.createElement(Pe.a,{type:"error"},h.cultureName)),a&&c.a.createElement(E.a,null,c.a.createElement(Se.a,{style:bt.input,value:p.title,placeholder:"Title",onSubmitEditing:function(){return y(O)},returnKeyType:"next",ref:k,label:"Title",mode:"outlined",onChangeText:d("title")}),h.title&&v.title&&c.a.createElement(Pe.a,{type:"error"},h.title)),a&&c.a.createElement(vt.a,null),c.a.createElement(E.a,null,c.a.createElement(Se.a,{style:bt.input,value:p.summary,onBlur:f("summary"),placeholder:"Summary",onSubmitEditing:function(){return y(S)},returnKeyType:"next",ref:O,label:"Summary",mode:"outlined",onChangeText:d("summary")}),h.summary&&v.summary&&c.a.createElement(Pe.a,{type:"error"},h.summary)),c.a.createElement(E.a,null,c.a.createElement(Se.a,{style:bt.input,value:p.description,onBlur:f("description"),placeholder:"Description",ref:S,returnKeyType:"next",label:"Description",mode:"outlined",onChangeText:d("description"),multiline:!0,numberOfLines:5}),h.description&&v.description&&c.a.createElement(Pe.a,{type:"error"},h.description)),c.a.createElement(vt.a,null),c.a.createElement(L.a,{style:bt.sourceTypeTitle},"Source Type"),c.a.createElement(gt.a.Group,{onValueChange:d("sourceType"),value:p.sourceType},c.a.createElement(gt.a.Item,{label:"Link",value:"link"})),c.a.createElement(vt.a,null),c.a.createElement(E.a,null,c.a.createElement(Se.a,{style:bt.input,value:p.source,onBlur:f("source"),placeholder:"Source",onSubmitEditing:g,ref:P,returnKeyType:"next",label:"Source",mode:"outlined",onChangeText:d("source")}),h.source&&v.source&&c.a.createElement(Pe.a,{type:"error"},h.source)),c.a.createElement(R.a,null,c.a.createElement(I.a,{style:bt.fab,icon:"check",onPress:g})))},Et=Ue.a().shape({password:Ue.c().required("Required").min(8,"Must be at least 8 characters").max(64,"Too long").matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]/,"Must contain at least one uppercase letter, one lowercase letter, one number and one special character"),passwordConfirmation:Ue.c().required("Required").oneOf([Ue.b("password"),null],"Must match password")}),xt={password:"",passwordConfirmation:""},kt=q.a.create({view:{flex:1,justifyContent:"space-evenly",overflow:"hidden"},input:{margin:5,padding:15},title:{alignSelf:"center"}});var Ot=function(e){var t=e.route,n=e.navigation,a=t.params?t.params.email:"",s=t.params?t.params.token:"",i=Object(o.useState)(""),u=w()(i,2),l=u[0],m=u[1],p=Object(o.useState)(!0),d=w()(p,2),f=d[0],h=d[1],v=Object(o.useState)(!0),g=w()(v,2),b=g[0],y=g[1],x=Object(o.useRef)(),k=Object(o.useRef)(),O=Object(Ce.a)({validationSchema:Et,initialValues:xt,onSubmit:function(e){return D(e)}}),S=O.values,P=O.handleChange,j=O.handleBlur,C=O.errors,I=O.touched,R=O.handleSubmit,D=function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(fe.updatePassword(a,e.password,e.passwordConfirmation,s));case 3:n.navigate("Login"),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),m(t.t0.toString()),console.error("Failed to update account: ",t.t0);case 10:case"end":return t.stop()}}),null,null,[[0,6]],Promise)};return c.a.createElement(E.a,{style:kt.view},c.a.createElement(L.a,{style:kt.title},"Let's create a new password!"),c.a.createElement(E.a,{style:kt.input},c.a.createElement(Se.a,{mode:"outlined",label:"password",ref:x,left:c.a.createElement(Se.a.Icon,{name:"lock"}),secureTextEntry:f,textContentType:"newPassword",onSubmitEditing:function(){var e;(e=k)&&e.current.focus()},returnKeyType:"next",error:C.password&&I.password,onBlur:j("password"),value:S.password,onChangeText:P("password"),right:c.a.createElement(Se.a.Icon,{name:f?"eye":"eye-off",onPress:function(){return h(!f)}})}),C.password&&I.password&&c.a.createElement(Pe.a,{type:"error"},C.password)),c.a.createElement(E.a,{style:kt.input},c.a.createElement(Se.a,{mode:"outlined",label:"password confirmation",textContentType:"password",ref:k,left:c.a.createElement(Se.a.Icon,{name:"shield-lock"}),secureTextEntry:b,error:C.passwordConfirmation&&I.passwordConfirmation,onBlur:j("passwordConfirmation"),onSubmitEditing:R,returnKeyType:"done",value:S.passwordConfirmation,onChangeText:P("passwordConfirmation"),right:c.a.createElement(Se.a.Icon,{name:b?"eye":"eye-off",onPress:function(){return y(!b)}})}),C.passwordConfirmation&&I.passwordConfirmation&&c.a.createElement(Pe.a,{type:"error"},C.passwordConfirmation)),c.a.createElement(T.a,{mode:"contained",onPress:R},"Recover"),c.a.createElement(A.a,{visible:""!==l,onDismiss:function(){return m("")},action:{label:"Ok",onPress:function(){return m("")}}},l))},St=n(19),Pt=n.n(St),jt=n(69);var Ct=Object(s.b)((function(e){return{theme:e.theme}}),(function(e){return Object(i.a)({updateTheme:Le},e)}))((function(e){var t=e.updateTheme,n=e.theme;Object(o.useEffect)((function(){!function(){var e;r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.a.awrap(m.a.getItem(ge));case 3:e=n.sent,n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),e="Light";case 9:e||(e="Light"),t(e);case 11:case"end":return n.stop()}}),null,null,[[0,6]],Promise)}()}),[]);var a=function(){var e;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t(e="Dark"===n?"Light":"Dark"),a.prev=2,a.next=5,r.a.awrap(m.a.setItem(ge,e));case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),console.log("failed to set theme");case 10:case"end":return a.stop()}}),null,null,[[2,7]],Promise)};return c.a.createElement(E.a,null,c.a.createElement(C.b.Item,{title:"Dark Theme",onPress:a,left:function(e){return c.a.createElement(U.a,Pt()({},e,{icon:"brightness-6",onPress:a}))},right:function(e){return c.a.createElement(je.a,Pt()({onPress:a},e,{status:"Dark"===n?"checked":"unchecked"}))}}))})),Tt=n(219),It=n.n(Tt),Rt=n(356),At=n.n(Rt),Dt=q.a.create({rightIcon:{right:-5},leftIcon:{left:-5},input:{padding:20},characterCounter:{fontSize:11,right:22,position:"absolute",bottom:20,paddingRight:2,paddingBottom:2},button:{padding:15,margin:10}});function zt(e){var t=Object(o.useState)(!1),n=w()(t,2),a=n[0],s=n[1],i=Object(o.useState)(new Map),u=w()(i,2),l=u[0],m=u[1],p=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(we.list());case 3:e=t.sent,t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),console.error("Failed to load ledger",t.t0),t.abrupt("return");case 10:if(e){t.next=12;break}return t.abrupt("return");case 12:m(e);case 13:case"end":return t.stop()}}),null,null,[[0,6]],Promise)};Object(o.useEffect)((function(){p()}),[]),Object(o.useEffect)((function(){var e=setInterval((function(){m(new Map(l.entries()))}),6e4);return function(){return clearInterval(e)}}));var d=Array.from(l.entries());return 0===l.size?null:c.a.createElement(E.a,null,c.a.createElement(C.b.Accordion,{expanded:a,onPress:function(){return s(!a)},title:"Downloaded Cultures",left:function(e){return c.a.createElement(C.b.Icon,Pt()({},e,{icon:"download",style:Dt.leftIcon}))}},c.a.createElement(V.a,{data:d,keyExtractor:function(e,t){return t.toString()},renderItem:function(e){var t=e.item,n=w()(t,2),a=n[0],o=n[1];return c.a.createElement(C.b.Item,{title:a,description:"Last modified "+It()().to(It.a.unix(o)),right:function(e){return c.a.createElement(U.a,Pt()({},e,{icon:"delete",onPress:function(){return function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return l.delete(e),t.prev=1,t.next=4,r.a.awrap(we.remove(e));case 4:t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(1),console.error("Failed to remove downloaded culture: ",t.t0),t.abrupt("return");case 10:m(new Map(l.entries()));case 11:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}(a)}}))}})}})),a&&c.a.createElement(T.a,{mode:"contained",onPress:function(){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(we.update());case 3:p(),e.onUpdateFinish(null),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e.onUpdateFinish(t.t0.toString()),console.error("Failed to update downloaded cultures: ",t.t0);case 11:case"end":return t.stop()}}),null,null,[[0,7]],Promise)}},"Update All"))}It.a.extend(At.a);function Bt(){var e=Object(o.useState)(!1),t=w()(e,2),n=t[0],a=t[1],s=Object(o.useState)(""),i=w()(s,2),u=i[0],l=i[1],m=Object(o.useState)("writing"),p=w()(m,2),d=p[0],f=p[1],h=function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==u){e.next=2;break}return e.abrupt("return");case 2:return f("sending"),e.prev=3,e.next=6,r.a.awrap(Ee.send(u));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),f("failed"),e.abrupt("return");case 12:f("sent");case 13:case"end":return e.stop()}}),null,null,[[3,8]],Promise)};return c.a.createElement(E.a,null,c.a.createElement(C.b.Accordion,{left:function(e){return c.a.createElement(C.b.Icon,Pt()({},e,{style:Dt.leftIcon,icon:"message-reply-text"}))},expanded:n,onPress:function(){return a(!n)},title:"Feedback"},"sent"===d&&c.a.createElement(T.a,{icon:"check",color:"green",mode:"contained",style:Dt.button,onPress:function(){f("writing"),l("")}},"Thank you"),"failed"===d&&c.a.createElement(T.a,{icon:"alert",color:"yellow",mode:"contained",style:Dt.button,onPress:function(){return f("writing")}},"Try again later"),("writing"===d||"sending"===d)&&c.a.createElement(Se.a,{style:Dt.input,mode:"outlined",multiline:!0,label:"How can we improve?",value:u,onSubmitEditing:function(){return h()},returnKeyType:"send",onChangeText:function(e){e.length>300||l(e)},numberOfLines:4,right:"writing"===d?c.a.createElement(Se.a.Icon,{name:"send",onPress:function(){return h()}}):c.a.createElement(Se.a.Icon,{name:"check"})}),("writing"===d||"sending"===d)&&c.a.createElement(Ke.a,{style:Dt.characterCounter},u.length+"/300")))}function Lt(e){var t=e.token,n=e.email,a=e.logout,s=e.navigation,i=Object(o.useState)(!1),u=w()(i,2),l=u[0],p=u[1],d=Object(o.useState)(!1),f=w()(d,2),h=f[0],v=f[1];Object(o.useEffect)((function(){!function(){var e;r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(m.a.getItem(ye));case 3:e=t.sent,t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),v(!1),t.abrupt("return");case 10:e&&v(!0);case 11:case"end":return t.stop()}}),null,null,[[0,6]],Promise)}()}),[]);var g=function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=h,e.next=!0===e.t0?3:!1===e.t0?14:24;break;case 3:return e.prev=3,e.next=6,r.a.awrap(m.a.removeItem(ye));case 6:e.next=12;break;case 8:return e.prev=8,e.t1=e.catch(3),v(!1),e.abrupt("return");case 12:return v(!1),e.abrupt("break",24);case 14:return e.prev=14,e.next=17,r.a.awrap(m.a.setItem(ye,n));case 17:e.next=23;break;case 19:return e.prev=19,e.t2=e.catch(14),v(!1),e.abrupt("return");case 23:v(!0);case 24:case"end":return e.stop()}}),null,null,[[3,8],[14,19]],Promise)};return c.a.createElement(E.a,null,c.a.createElement(C.b.Accordion,{expanded:l,onPress:function(){return p(!l)},title:"Account",left:function(e){return c.a.createElement(C.b.Icon,Pt()({},e,{icon:"account",style:Dt.leftIcon}))}},""!==t&&c.a.createElement(C.b.Item,{title:"Remember Email",onPress:function(){return g()},left:function(e){return c.a.createElement(U.a,Pt()({},e,{icon:"email",onPress:function(){return g()}}))},right:function(e){return c.a.createElement(je.a,Pt()({onPress:function(){return g()}},e,{status:h?"checked":"unchecked"}))}})),l&&c.a.createElement(E.a,null,t?c.a.createElement(T.a,{icon:"logout",mode:"contained",onPress:function(){a(),s.navigate("Home")}},"Log Out"):c.a.createElement(T.a,{icon:"login",mode:"contained",onPress:function(){s.navigate("Login")}},"Log In")))}var Nt=Object(s.b)((function(e,t){return{token:e.user.token,email:e.user.user.email,navigation:t.navigation}}),(function(e){return Object(i.a)({resetUser:Be},e)}))((function(e){var t=e.token,n=e.email,a=e.resetUser,r=e.navigation,s=function(){return D.a.openURL("http://www.google.com")},i=Object(o.useState)(""),u=w()(i,2),l=u[0],m=u[1];return c.a.createElement(jt.a,null,c.a.createElement(Ct,null),c.a.createElement(vt.a,null),c.a.createElement(C.b.Item,{title:"Disclaimer",onPress:s,left:function(e){return c.a.createElement(U.a,Pt()({},e,{style:Dt.leftIcon,onPress:s,icon:"file-document-outline"}))},right:function(e){return c.a.createElement(U.a,Pt()({},e,{icon:"eye",style:Dt.rightIcon,onPress:s}))}}),c.a.createElement(vt.a,null),c.a.createElement(Lt,{email:n,navigation:r,token:t,logout:a}),c.a.createElement(vt.a,null),c.a.createElement(Bt,null),c.a.createElement(vt.a,null),c.a.createElement(zt,{onUpdateFinish:function(e){return m(e||"Update finished")}}),c.a.createElement(R.a,null,c.a.createElement(A.a,{visible:""!==l,onDismiss:function(){return m("")},action:{label:"Ok",onPress:function(){return m("")}}},l)))})),Ut={prefixes:["/"],config:{screens:{Home:"/",Login:"login",Register:"register/:token",Recovery:"recovery/:email/:token",Culture:{path:"culture/:cultureName",parse:{cultureName:function(e){return decodeURI(e)}},screens:{general:"general",specialized:"specialized"}},EditInsight:"culture/edit/:culture/:index",Settings:"settings"}}},qt=Object(i.c)(Ne);var Ft=Object(s.b)((function(e){return{theme:e.theme}}),null)((function(e){var t=e.theme,n=Object(h.a)();return c.a.createElement(p.a,{linking:Ut,theme:"Dark"===t?d.a:f.a},c.a.createElement(l.a,{theme:"Dark"===t?et:Xe},c.a.createElement(u.StatusBar,{style:"Dark"===t?"light":"dark"}),c.a.createElement(n.Navigator,{initialRouteName:"Home"},c.a.createElement(n.Screen,{name:"Culture",component:Oe,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"Home",component:ht,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"Login",component:Ve,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"Register",component:Ge,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"EditInsight",component:wt,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"Settings",component:Nt,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}),c.a.createElement(n.Screen,{name:"Recovery",component:Ot,options:{headerTitleAlign:"left",headerBackTitleVisible:!1}}))))}));t.default=Object(v.a)((function(){return Object(o.useEffect)((function(){!function(){var e;r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.awrap(m.a.getItem(ge));case 3:e=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e="Light";case 9:e||(e="Light"),qt.dispatch(Le(e));case 11:case"end":return t.stop()}}),null,null,[[0,6]],Promise)}()}),[]),c.a.createElement(s.a,{store:qt},c.a.createElement(Ft,null))}))}},[[378,1,2]]]);
//# sourceMappingURL=app.a4cbfd6f.chunk.js.map